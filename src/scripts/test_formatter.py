from manuscriptFormatter import getFormattedManuscriptStreamForEpub
from os import chdir


class Test_accpetance_ebook_formatter:
    chdir('sample-manuscript')

    def test_new_format(self):
        assert getFormattedManuscriptStreamForEpub().read().decode() == old_epub_format


old_epub_format = """
# Est versat sed remorum ordine murice


## Tecumque quem rettuleram harena concipit

Lorem *markdownum procul domusque* fatetur subeant gerit, caelestibus, audent,
inrequietus. Gramen saxum huius.

![lean-image](resources/carlos.jpg)

Membra LEAN MIND[^lean] eripienda naufragus fors. Resecat lintea distentae et fui subitis lucis;
est sola tempus cum orbem ducunt crudelesque quae occidit ducibusque avertens
sileam. Reddere Typhoeus, facies fatisque homo! Ad positis, patulis clamato
veste sed grave sum, novae. Atque nec petiti gladios capitis, iam inpulsumque
pressa [LINK1](http://adsensit.net/visa-inperfectuadsdasd) damno *tegendas*. pressa [LINK2](http://adsensit.net/visa-inperfectus) damno *tegendas*.

[^lean]: Quae qui, de sine, tacuit, aequora saevorum inposito, parte ventrem pater;
mergor toto. Tantos hic auditis defuit fontes nobis dummodo.

```{title=Java}
if (61) {
    motherboard_dv(website + -2);
} else {
    win(down_it_white, right * mms_dos, binary_firewire_page);
}
if (integer_supercomputer) {
    num_cold_domain = gateway_crt_source(card) + full_cmos;
    p_windows_mouse /= software_trash.fsb(visualC, deprecated_portal, 2);
    joystickRealParty(3, clientExternal, memory_stack - core);
}
if (only < 3) {
    modeMouseBookmark = arp_lun_bot(dynamic, throughputKoffice,
            spywareBarebones);
} else {
    express(2);
    gibibyte_pptp = heuristicViralAccess;
}
```

Tecum praesepibus nova: flos pater nec Peneos possem torvo paventque, digitosque
aquosae mea **vacat** dominos voluptas. Nam coniunx
[remisso](http://inventos-sub.com/); id tori, non flenti, quae pelago *quae*
extulerat aures refer ubi coniuge nomen. Venasque mella manus manus repulsae ea
per, celatus fueritque mearum flava, vocant.

```{title=Python}
if (layout_ibm) {
    internal_undo(enterprisePdf(laptopImageAgp, memoryScalable, -5), 84 +
            iscsiKilobit, 1);
    cable = barcraft;
    botnet_virus.output -= 1;
}
vertical *= secondary / 2 + masterDosOptical + 5;
systemDynamicWebsite(engine);
kilobyte_syn_ajax /= user_atm_daemon(44);
```

Frustra erat cum remittit auras *calet* undas spiro lugubris excivere ferae
lacrimis Procrin messes ille. Promissa obliquum, erat sorores: **non** leves
modo, marcida [sol mentis poscit](http://proterva-scilicet.org/ille.php) omine,
plenaque aspera parentum recursus. Summo arcus: operatus tumultus secuti quanto
promittat abstulit siquid: requie pererrat vires iussit! Conclamat fessos furit
quinta, [haec](http://solvit-admonuit.net/fuerat) foliis, me pedes ut.

> Fidum denique quodsi [contraria limite](http://cautes.org/alcithoe.html) et
> obruta quoque. Os digna lacus hoc ora videtis habenas iracunda vultus non
> puellae.


## Pependit creati ipsum

Cava tuos per adsere exsistere ventos maestae; est moram maturuit ungulaque
pennis collis celeberrima. Primordia videor: coniunx precibus flammasque quaeras
tremescere esset fumis Telamon barbae stimulatus cecidit incurvae confudit
plena, atque antiqua. Sed ille carmina **silvarum** piscem. Duas regis cauda
scire, inmota oris ultima huius Talibus, spemque parte ad male.

Clamore Vasta oculis lymphae debilis roganti verendus mecum inscripsere hanc
madefactaque tecta turba scopulis caruit frondentis crederet, o? Vimque est
talibus venit, nubila in o lenta, hanc!

> Cum nil namque diruta quotiens quondam alimentaque. *Vox summe* pluma [membra
> et](http://www.siquis-sum.com/) parvoque possit ministrae potitur erat terga
> moratus. Praemia cum plura terrae verbis, omne nam protinus illi. Nunc qua
> collocat triennia substravit fuit viscera premebat es motuque! Et sibi
> redolentia harundine ille circuit Abarin lateri vani sors, est tepido bimarem
> stet ferum?

Atque nigris terraeque alto, succendit tibi. Iter modo coepisse, et scopulum per
nascuntur protinus: voluit virgis grave fudit conscendit omnia, nec manibus.
Crines humili mortale tibi.

1. Omnis cum deos
2. Cuspide inconsolabile orbem media
3. Maeonios mare
4. Illic num nomen vulnere
5. Vivacia pavonibus Pharonque crinibus adunca ponit erat

In densis, moveri falsamque; vetus ego, te? Spatioque nova exit; igne fores
collecti admonitu adsis harenosae per, quas gratissima.

- Lacrimarum deorum
- Fuerunt loco simul non inmansuetique aliae caeleste
- Succeditis lacertos odium
- Subdita accipit lapides motu
- Non rata mox

Nobis ut egredere posses. Cani *crura felicia* Molpeus, posita ipse tigride
conripiantque grave custos monet? Valida memorant ille est tali movit, o ingenio
frater contemptrix: crescere. Ipsa fontibus felix meminisse vultu admissum
viderat *faciem*, corniger has sacra vulnera cornua quod.

# Radiataque usus remittit


## Sanguine tristis Parrhasio dextra cinguntur Procnen et

Lorem markdownum Apollo adice; prorumpit petis piget, dixerunt. Sacrisque
fraude, coronatis sanguine. Qua passim, dempto suos notatam. Pictos [si occidit
animus](http://www.nefandas-totidemque.com/) titubantis refert, huic fratres
petit removete mutilatae inpetus [honorem](http://lampades.com/vulnere-harenae)!

Imo coniugium natorum. Sentire quam, funereum; sed nunc scopulis vitamque:
virgo. Nunc pondus pennas, numen Palatinae cum sulphura comes.

- Pressa exstinctos distulit crimen fretum fluit iocos
- Deum Elide fila
- Instar habet vestigia
- Saxa ferant pennas Achaemenide munus est
- Adsonat nymphas obstrepuere solis progenitore arquato harena
- Etiam sequitur quanto Niobe


## Nata argenteus virgineos ventis res

Torva dat Buten dividuae puellae, generi, horrescere **veretur** Argolicam! Nisi
genitus, in caelo propensum carina cum, o carinae regia formosius dilexisse in
veri. Auxilium quos nec sua quaecumque ratos arbore collum facto sua salutis
silicem densus Thermodontiaca, ergo senior tela cum.

1. Umbram reliquit fallacia
2. Buxi dare eodem se iuventus est adporrectumque
3. Aestu vatum

Et patrii stet silvas rapta haerens iuvenis: sub accipis perculit. Lacu minus
agros, tenebras colla undis Telamonque sonuere corpora!


## Vires et Rhesi Nec in vel vultum

Auctor quem imagine et Phoebi ossa! Ramos mitissimus rerum credule
[loquendo](http://quotiens.net/terras.html) erratica populisque fatus remitti
veniunt seu, en, et profugos. Et a nectare cadme et tunc facundia Mnemonidas
omnes, reverentia? Nova nimiique reclusa fatigat seram, certamina rubescunt, oro
procerum, albet vincirem, Enaesimus et hunc motis, ensem. Lumina succedere
Iliaden.

Ius erat pectora tempora capillos verum corporibus telluris tulit, dracones
laeva praeposuisse fatebar. Regemque alma, verbis fulvo, non Phaethon, meum
mulcendas frangit: amictu auras Diana. Dixerat *eheu* agger, servabat instant,
nomen ventis petis.


## Elige scit

Mente mihi Anius quantum praecluditur
[parat](http://harenam-pelops.org/gemellam), petentem extremum modo. Caelo modo
nescia, madidisque **velle terrent neve** versa. Est nimbi.

```
bitFlatbedPhishing.process_dot = system_scalable;
soa.push_ole = null;
method_crop -= sip;
if (video.tape_barcraft(1)) {
    mnemonic = of_cut + drive_undo;
    fileSwappablePhishing += 419899;
    richIcann(widget_stack_overwrite, diskSidebarFile, camelcase);
} else {
    scanRfid(nui(55), 5, multitasking);
    function_error_network /= fi_drm;
    cardSubdirectoryClient.swappableFileJson = copyright_definition;
}
winsock_text_itunes = archiveLocalhost(function_down_hit, cronPublishing(floppy(
        fileNewbieInstall), access_word_latency(motherboard,
        middleware_mini_file)));
```


## Naturae magna fata

Nudum grave. Illo adhuc gelidoque quisquis lacertos, inplet annis: sine solvere.

```
var unicode = cdmaSram(rightMalwareDefragment, wizard, tcp_secondary);
if (tablet) {
    software(minisite_dpi_controller, seo);
    kde_snmp = mainframeRepeaterBoolean;
    trackballDpiInput = blob_denial;
}
if (sanWrapSampling) {
    fontDigital.rate_finder_framework = 25 / gbpsSanHard - suffix;
    unix_vpn = link_d.parse(worm, ibm_data_spooling);
    spam_sram -= 98;
} else {
    petaflopsOverclockingDma = key_alu_illegal + 2;
}
```


## Ira inmanemque mariti patrios et natus

Metuam retractat nubemque solent iacent si nostraque saepe certamine fortissime
Cyparisse auro amplexumque laudando, illi armarat pro tantum! Echecli erat
referens saxa premens flumen iacet quaesita omnes hasta, adeste. Cratere iura;
**inlaesas tenet** forent luget vetustas meum pallor **barbarus ad illa**, e
antiquique vidit obtulit, sive? Ego accingitur oculos, fidissima terra et
desinis funera, **sacra silva**, infelix Tantalides, Lenaee. Sed mucrone parsque
quod sagitta incinctus inquit [Achillea equi
montes](http://ille-herse.com/optasse-pheretiade): ego?

```
controller(ibm, baud_unit.white_mask(computer_software_linux, asp));
if (intelligence_analyst(netbios.modem.touchscreen_bespoke(
        digital_express_markup, outputOperating(2, cdPassive), 2))) {
    fileCharacter(wheelThumbnail(megahertz), variableDelUndo);
}
if (macintosh.certificate.bar_redundancy_bittorrent(push + matrix +
        typeface_ring)) {
    mail_mouse.piconet.activeCamera(backlink_link, 2, icioVga);
}
```

Priamus diuque peperit *utraque*; terque tu certate regna volat miserque
Orpheus. Vetantis caede tantaeque fiducia vitiatas et revincta resistere timent
tuus pius elusam frugum: risi India regio. Sinuatoque conferat Hesperio caelo
nomen et carmina! Mansit et tauri iusta altera *eodem*, prospexerat enim
praedator ea procul, ense.
"""
